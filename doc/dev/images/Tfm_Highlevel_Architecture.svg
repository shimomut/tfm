<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg viewBox="0 0 1920 1080" width="1920" height="1080" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style type="text/css">
      <![CDATA[
      .title { font: bold 32px sans-serif; fill: #ecf0f1; }
      .subtitle { font: bold 20px sans-serif; fill: #ecf0f1; }
      .label { font: 16px sans-serif; fill: #ecf0f1; }
      .small-label { font: 14px sans-serif; fill: #bdc3c7; }
      
      .app-layer { fill: #1a5490; stroke: #154070; stroke-width: 3; }
      .manager-layer { fill: #8b2e24; stroke: #6b1e14; stroke-width: 3; }
      .ui-layer { fill: #1e7e34; stroke: #165a28; stroke-width: 3; }
      .storage-layer { fill: #9a6308; stroke: #7a4d06; stroke-width: 3; }
      .ttk-layer { fill: #5e2d70; stroke: #4a2358; stroke-width: 3; }
      .backend-layer { fill: #0e7c66; stroke: #0a5c4a; stroke-width: 3; }
      
      .arrow { stroke: #7fb3d5; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .data-flow { stroke: #95a5a6; stroke-width: 2; fill: none; stroke-dasharray: 8,4; }
      ]]>
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#7fb3d5" />
    </marker>
  </defs>
  
  <!-- Black background -->
  <rect width="1920" height="1080" fill="#000000"/>
  
  <!-- Title -->
  <text x="960" y="50" text-anchor="middle" class="title">TFM High-Level Architecture</text>
  <text x="960" y="85" text-anchor="middle" class="small-label">Layered architecture with clear separation of concerns</text>
  
  <!-- Application Layer -->
  <g transform="translate(760, 130)">
    <rect x="0" y="0" width="600" height="100" class="app-layer" rx="8"/>
    <text x="300" y="35" text-anchor="middle" class="subtitle">Application Layer</text>
    <text x="300" y="60" text-anchor="middle" class="label">FileManager (tfm_main.py)</text>
    <text x="300" y="82" text-anchor="middle" class="small-label">Main controller • Event loop • Coordination • State management</text>
  </g>
  
  <!-- Manager Systems Layer -->
  <g transform="translate(260, 280)">
    <rect x="0" y="0" width="1600" height="140" class="manager-layer" rx="8"/>
    <text x="800" y="35" text-anchor="middle" class="subtitle">Manager Systems</text>
    
    <!-- Manager boxes -->
    <g transform="translate(40, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#6b1e14" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">PaneManager</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Dual pane navigation</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Cursor history</text>
    </g>
    
    <g transform="translate(290, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#6b1e14" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">FileOperations</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Copy • Move • Delete</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Threading • Progress</text>
    </g>
    
    <g transform="translate(540, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#6b1e14" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">LogManager</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Unified logging</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Remote monitoring</text>
    </g>
    
    <g transform="translate(790, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#6b1e14" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">StateManager</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Persistence</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">History • Config</text>
    </g>
    
    <g transform="translate(1040, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#6b1e14" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">ProgressManager</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Progress tracking</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Cancellation</text>
    </g>
    
    <g transform="translate(1290, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#6b1e14" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">MenuManager</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Desktop menus</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Menu state</text>
    </g>
  </g>
  
  <!-- UI Components Layer -->
  <g transform="translate(260, 470)">
    <rect x="0" y="0" width="1100" height="140" class="ui-layer" rx="8"/>
    <text x="550" y="35" text-anchor="middle" class="subtitle">UI Components (UILayer Stack)</text>
    
    <!-- UI component groups -->
    <g transform="translate(40, 55)">
      <rect x="0" y="0" width="320" height="65" fill="#165a28" rx="5"/>
      <text x="160" y="25" text-anchor="middle" class="label">Viewer Classes</text>
      <text x="160" y="45" text-anchor="middle" class="small-label">TextViewer • DiffViewer</text>
      <text x="160" y="60" text-anchor="middle" class="small-label">DirectoryDiffViewer</text>
    </g>
    
    <g transform="translate(380, 55)">
      <rect x="0" y="0" width="320" height="65" fill="#165a28" rx="5"/>
      <text x="160" y="25" text-anchor="middle" class="label">Dialog Classes</text>
      <text x="160" y="45" text-anchor="middle" class="small-label">ListDialog • SearchDialog</text>
      <text x="160" y="60" text-anchor="middle" class="small-label">InfoDialog • BatchRename</text>
    </g>
    
    <g transform="translate(720, 55)">
      <rect x="0" y="0" width="320" height="65" fill="#165a28" rx="5"/>
      <text x="160" y="25" text-anchor="middle" class="label">Input Components</text>
      <text x="160" y="45" text-anchor="middle" class="small-label">QuickChoiceBar</text>
      <text x="160" y="60" text-anchor="middle" class="small-label">QuickEditBar</text>
    </g>
  </g>
  
  <!-- UILayerStack System -->
  <g transform="translate(1410, 470)">
    <rect x="0" y="0" width="450" height="140" class="ui-layer" rx="8"/>
    <text x="225" y="35" text-anchor="middle" class="subtitle">UILayerStack System</text>
    <text x="225" y="65" text-anchor="middle" class="label">Stack-based UI management</text>
    <text x="225" y="88" text-anchor="middle" class="small-label">Event routing to top layer</text>
    <text x="225" y="108" text-anchor="middle" class="small-label">Optimized rendering</text>
    <text x="225" y="128" text-anchor="middle" class="small-label">Modal dialog support</text>
  </g>
  
  <!-- Storage Abstraction Layer -->
  <g transform="translate(260, 660)">
    <rect x="0" y="0" width="1600" height="140" class="storage-layer" rx="8"/>
    <text x="800" y="35" text-anchor="middle" class="subtitle">Storage Abstraction Layer</text>
    
    <!-- Path interface -->
    <g transform="translate(40, 55)">
      <rect x="0" y="0" width="480" height="65" fill="#7a4d06" rx="5"/>
      <text x="240" y="25" text-anchor="middle" class="label">Path (Polymorphic Interface)</text>
      <text x="240" y="45" text-anchor="middle" class="small-label">Unified API for all storage types</text>
      <text x="240" y="60" text-anchor="middle" class="small-label">Storage-agnostic operations</text>
    </g>
    
    <!-- Storage implementations -->
    <g transform="translate(560, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#7a4d06" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">LocalPathImpl</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">Local filesystem</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">pathlib wrapper</text>
    </g>
    
    <g transform="translate(810, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#7a4d06" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">SSHPathImpl</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">SFTP protocol</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Connection pooling</text>
    </g>
    
    <g transform="translate(1060, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#7a4d06" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">S3PathImpl</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">AWS S3 buckets</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Virtual directories</text>
    </g>
    
    <g transform="translate(1310, 55)">
      <rect x="0" y="0" width="230" height="65" fill="#7a4d06" rx="5"/>
      <text x="115" y="25" text-anchor="middle" class="label">ArchivePathImpl</text>
      <text x="115" y="45" text-anchor="middle" class="small-label">ZIP • TAR • GZ</text>
      <text x="115" y="60" text-anchor="middle" class="small-label">Virtual browsing</text>
    </g>
  </g>
  
  <!-- TTK Framework Layer -->
  <g transform="translate(260, 850)">
    <rect x="0" y="0" width="1100" height="140" class="ttk-layer" rx="8"/>
    <text x="550" y="35" text-anchor="middle" class="subtitle">TTK Framework (Terminal Toolkit)</text>
    
    <g transform="translate(40, 55)">
      <rect x="0" y="0" width="320" height="65" fill="#4a2358" rx="5"/>
      <text x="160" y="25" text-anchor="middle" class="label">Event System</text>
      <text x="160" y="45" text-anchor="middle" class="small-label">KeyEvent • MouseEvent</text>
      <text x="160" y="60" text-anchor="middle" class="small-label">SystemEvent • MenuEvent</text>
    </g>
    
    <g transform="translate(380, 55)">
      <rect x="0" y="0" width="320" height="65" fill="#4a2358" rx="5"/>
      <text x="160" y="25" text-anchor="middle" class="label">Text Utilities</text>
      <text x="160" y="45" text-anchor="middle" class="small-label">Wide char support</text>
      <text x="160" y="60" text-anchor="middle" class="small-label">Text layout engine</text>
    </g>
    
    <g transform="translate(720, 55)">
      <rect x="0" y="0" width="320" height="65" fill="#4a2358" rx="5"/>
      <text x="160" y="25" text-anchor="middle" class="label">Rendering Abstractions</text>
      <text x="160" y="45" text-anchor="middle" class="small-label">Backend-agnostic API</text>
      <text x="160" y="60" text-anchor="middle" class="small-label">Color • Attributes</text>
    </g>
  </g>
  
  <!-- Backend Layer -->
  <g transform="translate(1410, 850)">
    <rect x="0" y="0" width="450" height="140" class="backend-layer" rx="8"/>
    <text x="225" y="35" text-anchor="middle" class="subtitle">Backend Implementations</text>
    
    <g transform="translate(40, 55)">
      <rect x="0" y="0" width="170" height="65" fill="#0a5c4a" rx="5"/>
      <text x="85" y="30" text-anchor="middle" class="label">Curses</text>
      <text x="85" y="50" text-anchor="middle" class="small-label">Terminal mode</text>
    </g>
    
    <g transform="translate(230, 55)">
      <rect x="0" y="0" width="170" height="65" fill="#0a5c4a" rx="5"/>
      <text x="85" y="30" text-anchor="middle" class="label">CoreGraphics</text>
      <text x="85" y="50" text-anchor="middle" class="small-label">Desktop mode</text>
    </g>
  </g>
  
  <!-- Arrows showing data flow -->
  <!-- App to Managers -->
  <path d="M 1060 230 L 1060 280" class="arrow"/>
  
  <!-- Managers to UI -->
  <path d="M 810 420 L 810 470" class="arrow"/>
  
  <!-- UI to Storage -->
  <path d="M 810 610 L 810 660" class="arrow"/>
  
  <!-- Storage to TTK -->
  <path d="M 810 800 L 810 850" class="arrow"/>
  
  <!-- TTK to Backend -->
  <path d="M 1360 920 L 1410 920" class="arrow"/>
  
  <!-- UILayerStack to App (feedback) -->
  <path d="M 1635 470 L 1635 400 Q 1635 280 1360 180" class="arrow"/>
  
  <!-- Left side layer annotations -->
  <text x="100" y="180" text-anchor="start" class="small-label">Main control flow</text>
  <text x="100" y="350" text-anchor="start" class="small-label">Business logic</text>
  <text x="100" y="540" text-anchor="start" class="small-label">User interface</text>
  <text x="100" y="730" text-anchor="start" class="small-label">Data access</text>
  <text x="100" y="920" text-anchor="start" class="small-label">Platform layer</text>
  
  <!-- Footer -->
  <text x="960" y="1050" text-anchor="middle" class="small-label">Clean separation enables testability, maintainability, and extensibility</text>
</svg>
